<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Book Rating</title>
    <style>
      body {
        font-family: Arial;
        padding: 20px;
        max-width: 600px;
        margin: auto;
      }
      input,
      button {
        margin: 10px 0;
        width: 100%;
        padding: 8px;
      }
      label {
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h2>Book Rating Form</h2>

    <label>Book Name</label>
    <input type="text" id="book_name" />

    <label>Writer/Translator</label>
    <input type="text" id="writer" />

    <label>Story</label>
    <input type="number" id="story" min="0" max="10" />

    <label>Characters</label>
    <input type="number" id="characters" min="0" max="10" />

    <label>Writing Style</label>
    <input type="number" id="writing_style" min="0" max="10" />

    <label>World Building</label>
    <input type="number" id="world_building" min="0" max="10" />

    <label>Emotion</label>
    <input type="number" id="emotion" min="0" max="10" />

    <label>Originality</label>
    <input type="number" id="originality" min="0" max="10" />

    <label>Pacing</label>
    <input type="number" id="pacing" min="0" max="10" />

    <label>Enjoyment</label>
    <input type="number" id="enjoyment" min="0" max="10" />

    <button onclick="submitForm()">Submit Rating</button>

    <p id="result"></p>

    <script>
      async function submitForm() {
        const getVal = (id) => Number(document.getElementById(id).value) || 0;

        const data = {
          book_name: document.getElementById("book_name").value,
          writer: document.getElementById("writer").value,
          story: getVal("story"),
          characters: getVal("characters"),
          writing_style: getVal("writing_style"),
          world_building: getVal("world_building"),
          emotion: getVal("emotion"),
          originality: getVal("originality"),
          pacing: getVal("pacing"),
          enjoyment: getVal("enjoyment"),
        };

        const scores = [
          data.story,
          data.characters,
          data.writing_style,
          data.world_building,
          data.emotion,
          data.originality,
          data.pacing,
          data.enjoyment,
        ];
        data.avg_rating = (
          scores.reduce((a, b) => a + b, 0) / scores.length
        ).toFixed(2);

        const webhookURL =
          "https://script.google.com/macros/s/AKfycbzxr36OrnqOXiLmFOHNu3mefxu1zEu8tSolMSJ8OhxcFdhm-wElj7KNvPm3EqKfmlYM/exec";

        const response = await fetch(webhookURL, {
          method: "POST",
          body: JSON.stringify(data),
          headers: {
            "Content-Type": "application/json",
          },
        });

        const text = await response.text();
        document.getElementById("result").innerText = text;
      }
    </script>
  </body>
</html>
